/**
 * Navigation Service
 * @format
 */

import React from 'react';
import { CommonActions, StackActions } from '@react-navigation/native';

// Navigation container reference
const navigationRef = React.createRef();
const isReady = React.createRef();

// Navigate to a route
function navigate(name, params) {
  console.log('üß≠ NavigationService: navigate called with:', { name, params });
  console.log('üß≠ NavigationService: navigationRef.current:', !!navigationRef.current);
  console.log('üß≠ NavigationService: isReady.current:', isReady.current);
  
  if (!navigationRef.current) {
    console.error('‚ùå NavigationService: navigationRef.current is null');
    return;
  }
  
  try {
    navigationRef.current.dispatch(CommonActions.navigate({ name, params }));
    console.log('‚úÖ NavigationService: Navigation dispatched successfully');
  } catch (error) {
    console.error('‚ùå NavigationService: Navigation failed:', error);
  }
}

// Go back from current screen to previous
function goBack() {
  navigationRef.current?.dispatch(CommonActions.goBack());
}

// Replace current screen with provided screen
function replace(name, params) {
  navigationRef.current?.dispatch(StackActions.replace(name, params));
}

export const NavigationService = {
  navigationRef,
  navigate,
  goBack,
  replace,
  isReady,
};
